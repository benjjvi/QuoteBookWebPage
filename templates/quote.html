{% extends "base.html" %}

{% block title %}Quote #{{ id }}{% endblock %}

{% block extra_css %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='assets/css/quote.css') }}"
/>
{% endblock %}

{% block content %}
<main class="quote-page">
  <article class="quote-card">

    {% if not reroll_button %}
      <header class="quote-header">
        <span class="quote-id">Quote #{{ id }}</span>
      </header>
    {% endif %}


    <blockquote class="quote-text">
      “{{ quote }}”
    </blockquote>

    <div class="quote-author">
      — {{ author }}
    </div>

    {% if context %}
      <div class="quote-context">
        <strong>Context:</strong> {{ context }}
      </div>
    {% endif %}

    <div class="quote-meta">
      <span>{{ date }}</span>
      <span>•</span>
      <span>{{ time }}</span>
    </div>

    <div class="quote-actions">
      <a href="{{ url_for('index') }}" class="btn btn-secondary">
        Back home
      </a>

      {% if reroll_button %}
        <a href="{{ url_for('random') }}" class="btn btn-primary">
          Another quote
        </a>
      {% endif %}


      <button class="btn btn-primary" onclick="copyQuote()">
        Copy quote
      </button>

      <button class="btn btn-primary" onclick="permalinkQuote()">
        Permalink
      </button>
    </div>

    <script>
      function copyQuote() {
        const text = `“{{ quote }}” — {{ author }}`;
        navigator.clipboard.writeText(text).then(() => {
          alert("Quote copied!");
        });
      }
    </script>

    <script>
      function permalinkQuote() {
        const url = "https://benjjvi.pythonanywhere.com/quote/{{ id }}?_external=1";
        navigator.clipboard.writeText(url).then(() => {
          alert("Permalink copied!");
        });
      }
    </script>


  </article>
</main>
{% endblock %}
