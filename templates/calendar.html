{% extends "base.html" %}

{% block title %}Calendar {{ year }}-{{ "%02d"|format(month) }}{% endblock %}

{% block extra_css %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='assets/css/calendar.css') }}"
/>
{% endblock %}

{% block content %}
<section class="calendar-page">
  <header class="calendar-header">
    <div>
      <span class="eyebrow">Timeline</span>
      <h1>Quote Calendar</h1>
      <p class="lead">Tap a day to see everything that landed there.</p>
    </div>
    <a href="{{ url_for('index') }}" class="btn btn-ghost">Back home</a>
  </header>

  <form
    class="calendar-controls"
    onsubmit="event.preventDefault(); window.location.href = `/timeline/${this.year.value}/${this.month.value}`;"
  >
    <label class="control-label" for="month">Month</label>
    <div class="select-wrap">
      <select name="month" id="month" class="calendar-select">
        {% for m in months %}
          <option value="{{ m }}" {% if m == month %}selected{% endif %}>
            {{ m | month_name }}
          </option>
        {% endfor %}
      </select>
      <span class="select-icon">▾</span>
    </div>

    <label class="control-label" for="year">Year</label>
    <div class="select-wrap">
      <select name="year" id="year" class="calendar-select">
        {% for y in years %}
          <option value="{{ y }}" {% if y == year %}selected{% endif %}>
            {{ y }}
          </option>
        {% endfor %}
      </select>
      <span class="select-icon">▾</span>
    </div>

    <button type="submit" class="btn btn-primary">Go</button>
  </form>

  <div class="calendar-grid">
    {% for week in calendar_days %}
      {% for day in week %}
        {% if day.in_month and day.count > 0 %}
          <a
            class="day-card clickable"
            href="{{ url_for('quotes_by_day', timestamp=day.timestamp) }}"
          >
            <div class="day-badge" style="--size: {{ 26 + (day.count * 3) }}px;">
              <span>{{ day.date.day }}</span>
            </div>
            <p class="day-count">{{ day.count }} quote{% if day.count != 1 %}s{% endif %}</p>
          </a>
        {% else %}
          <div class="day-card disabled">
            <span class="day-number">{{ day.date.day }}</span>
          </div>
        {% endif %}
      {% endfor %}
    {% endfor %}
  </div>
</section>
{% endblock %}
